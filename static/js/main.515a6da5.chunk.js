(window["webpackJsonpreact-chat-tutorial"]=window["webpackJsonpreact-chat-tutorial"]||[]).push([[0],{201:function(e,t,a){e.exports=a.p+"static/media/wave.86c27fea.svg"},202:function(e,t,a){e.exports=a.p+"static/media/play.65f03140.svg"},203:function(e,t,a){e.exports=a.p+"static/media/pause.a61933e8.svg"},207:function(e,t,a){e.exports=a.p+"static/media/readed.2da46147.svg"},208:function(e,t,a){e.exports=a.p+"static/media/noreaded.1456f013.svg"},226:function(e,t,a){e.exports=a(487)},237:function(e,t,a){},278:function(e,t,a){},279:function(e,t,a){},379:function(e,t,a){},380:function(e,t,a){},381:function(e,t,a){},382:function(e,t,a){},388:function(e,t,a){},389:function(e,t,a){},452:function(e,t,a){},481:function(e,t){},484:function(e,t,a){},485:function(e,t,a){},487:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(9),c=a.n(s),l=a(30),i=a(13),o=a(43),u=a(193),m=a(194),d=a(222),p=a(195),g=a(224),f=a(100),E=a(489),h=a(490),v=a(14),_=a(105),b=a(2),y=a.n(b),O=(a(237),function(e){return r.a.createElement("div",null,r.a.createElement(_.a,Object.assign({},e,{className:y()("button",e.className,{"button--large":"large"===e.size})})))}),S=(a(278),function(e){var t=e.children,a=e.className;return r.a.createElement("div",{className:y()("block",a)},t)}),j=a(18),N=a(201),w=a.n(N),D=a(202),I=a.n(D),A=a(203),k=a.n(A),M=function(e,t,a){return t[e]?a[e]?"error":"success":""},L=a(99),R=a.n(L),T=a(492),P=function(e){var t=e.text,a=e.type,n=void 0===a?"info":a,r=e.title,s=e.duration,c=void 0===s?3:s;return T.a[n]({message:r,description:t,duration:c})},C=(a(279),function(e){var t=e.audioSrc,a=Object(n.useRef)(null),s=Object(n.useState)(!1),c=Object(j.a)(s,2),l=c[0],i=c[1],o=Object(n.useState)(0),u=Object(j.a)(o,2),m=u[0],d=u[1],p=Object(n.useState)(0),g=Object(j.a)(p,2),f=g[0],E=g[1];Object(n.useEffect)(function(){a.current.volume="0.1",a.current.addEventListener("playing",function(){i(!0)},!1),a.current.addEventListener("ended",function(){i(!1),d(0),E(0)},!1),a.current.addEventListener("pause",function(){i(!1)},!1),a.current.addEventListener("timeupdate",function(){var e=a.current&&a.current.duration||0;E(a.current.currentTime),d(a.current.currentTime/e*100)})},[]);return r.a.createElement("div",{className:"message__audio"},r.a.createElement("audio",{ref:a,src:t,preload:"auto"}),r.a.createElement("div",{className:"message__audio-progress",style:{width:m+"40%"}}),r.a.createElement("div",{className:"message__audio-info"},r.a.createElement("div",{className:"message__audio-btn"},r.a.createElement("button",{onClick:function(){l?a.current.pause():a.current.play()}},l?r.a.createElement("img",{src:k.a,alt:"Pause svg"}):r.a.createElement("img",{src:I.a,alt:"Play svg"}))),r.a.createElement("div",{className:"message__audio-wave"},r.a.createElement("img",{src:w.a,alt:"Wave svg"})),r.a.createElement("span",{className:"message__audio-duration"},function(e){var t=Math.floor(e/60),a=(e%60).toFixed();return"".concat(t<10?"0":"").concat(t,":").concat(a<10?"0":"").concat(a)}(f))))}),x=function(e){e.avatar;var t=e.user,a=e.text,n=e.date,s=e.isMe,c=e.isReaded,l=e.attachments,i=e.isTyping,o=e.audio;return r.a.createElement("div",{className:y()("message",{"message--isme":s,"message--is-typing":i,"message--image":l&&1===l.length,"message--is-audio":o})},r.a.createElement("div",{className:"message__content"},r.a.createElement(Y,{isMe:s,isReaded:c}),r.a.createElement("div",{className:"message__avatar"},r.a.createElement(se,{user:t})),r.a.createElement("div",null,r.a.createElement("div",{className:"message__info"},(o||a||i)&&r.a.createElement("div",{className:"message__bubble"},a&&r.a.createElement("p",{className:"message__text"},a),i&&r.a.createElement("div",{className:"message__typing"},r.a.createElement("span",null),r.a.createElement("span",null),r.a.createElement("span",null)),o&&r.a.createElement(C,{audioSrc:o})),l&&r.a.createElement("div",{className:"message__attachments"},l.map(function(e,t){return r.a.createElement("div",{key:t,className:"message__attachments-item"},r.a.createElement("img",{src:e.url,alt:e.filename}))})),n&&r.a.createElement("span",{className:"message__date"},r.a.createElement(X,{date:n}))))))};x.defaultProps={user:{}};var U=x,G=a(140),z=a(223),B=function(e){var t,a=e._id,n=e.unreaded,s=e.isMe,c=e.onSelect,i=e.currentDialogId,o=e.lastMessage;return r.a.createElement(l.b,{to:"/dialog/".concat(a)},r.a.createElement("div",{className:y()("dialogs__item",{"dialogs__item--online":o.user.isOnline,"dialogs__item--selected":i===a}),onClick:c.bind(void 0,a)},r.a.createElement("div",{className:"dialogs__item-avatar"},r.a.createElement(se,{user:o.user})),r.a.createElement("div",{className:"dialogs__item-info"},r.a.createElement("div",{className:"dialogs__item-info-top"},r.a.createElement("b",null,o.user.fullname),r.a.createElement("span",null,(t=new Date(o.createdAt),Object(z.a)(t)?Object(G.a)(t,"HH:mm"):Object(G.a)(t,"dd.MM.yyyy")))),r.a.createElement("div",{className:"dialogs__item-info-bottom"},r.a.createElement("p",null,o.text),s&&r.a.createElement(Y,{isMe:!0,isReaded:!1}),n>0&&r.a.createElement("div",{className:"dialogs__item-info-bottom-count"},n>9?"+9":n)))))},V=a(1),F=a.n(V),H=a(220),Z=a(206),W=a.n(Z),J=function(e){var t=e.date;return Object(H.a)(t,{addSuffix:!0,locale:W.a})};J.propTypes={date:F.a.object};var X=J,K=a(207),$=a.n(K),q=a(208),Q=a.n(q),Y=function(e){var t=e.isMe,a=e.isReaded;return t&&(a?r.a.createElement("img",{className:"message__icon-readed",src:$.a,alt:"Readed icon"}):r.a.createElement("img",{className:"message__icon-readed message__icon-readed--no",src:Q.a,alt:"No readed icon"}))||null},ee=a(209),te=a.n(ee),ae=a(64),ne=(a(379),function(e){var t=e.items,a=e.userId,n=e.onSearch,s=e.inputValue,c=e.currentDialogId,l=e.onSelectDialog;return r.a.createElement("div",{className:"dialogs"},r.a.createElement("div",{className:"dialogs__search"},r.a.createElement(h.a.Search,{value:s,placeholder:"\u041f\u043e\u0438\u0441\u043a \u0441\u0440\u0435\u0434\u0438 \u043a\u043e\u043d\u0442\u0430\u043a\u0442\u043e\u0432",onChange:function(e){return n(e.target.value)}})),t.length?te()(t,["created_at"],["desc"]).map(function(e){return r.a.createElement(B,Object.assign({onSelect:l,key:e._id,isMe:e.author._id===a,currentDialogId:c},e))}):r.a.createElement(ae.a,{image:ae.a.PRESENTED_IMAGE_SIMPLE,description:"\u041d\u0438\u0447\u0435\u0433\u043e \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e"}))}),re=(a(380),function(e){var t=e.avatar,a=e.user,n=e.text,s=e.date,c=e.isMe,l=e.isReaded,i=e.attachments,o=e.isTyping;return r.a.createElement("div",{className:y()("message",{"message--isme":c,"message--is-typing":o,"message--image":i&&1===i.length})},r.a.createElement("div",{className:"message__content"},r.a.createElement(Y,{isMe:c,isReaded:l}),r.a.createElement("div",{className:"message__avatar"},r.a.createElement("img",{src:t,alt:"Avatar ".concat(a.fullName)})),r.a.createElement("div",null,r.a.createElement("div",{className:"message__info"},(n||o)&&r.a.createElement("div",{className:"message__bubble"},n&&r.a.createElement("p",{className:"message__text"},n),o&&r.a.createElement("div",{className:"message__typing"},r.a.createElement("span",null),r.a.createElement("span",null),r.a.createElement("span",null))),r.a.createElement("div",{className:"message__attachments"},i&&i.map(function(e){return r.a.createElement("div",{className:"message__attachments-item"},r.a.createElement("img",{src:e.url,alt:e.filename}))})),s&&r.a.createElement("span",{className:"message__date"},r.a.createElement(X,{date:s}))))))});re.defaultProps={user:{}};a(381);var se=function(e){var t=e.user;if(t.avatar)return r.a.createElement("img",{className:"avatar",src:t.avatar,alt:"Avatar ".concat(t.fullname)});var a=function(e){var t=e.substr(0,3).split("").map(function(e){return(t=e.charCodeAt(0))>255?255:t<0?0:t>255?255:t<0?0:t;var t}),a=Object(j.a)(t,3),n=a[0],r=a[1],s=a[2];return{color:R()({r:n,g:r,b:s}).lighten(10).saturate(10).toHexString(),colorLighten:R()({r:n,g:r,b:s}).lighten(30).saturate(30).toHexString()}}(t._id),n=a.color,s=a.colorLighten,c=t.fullname[0].toUpperCase();return r.a.createElement("div",{style:{background:"linear-gradient(135deg, ".concat(n," 0%, ").concat(s," 96.52%)")},className:"avatar avatar--symbol"},c)},ce=(a(382),function(e){var t=e.online,a=e.fullname;return r.a.createElement("div",{className:"chat__dialog-header-center"},r.a.createElement("b",{className:"chat__dialog-header-username"},a),r.a.createElement("div",{className:"chat__dialog-header-status"},r.a.createElement("span",{className:y()("status",{"status--online":t})},t?"\u043e\u043d\u043b\u0430\u043d":"\u043e\u0444\u043b\u0430\u0439\u043d")))}),le=a(211),ie=a(219),oe=(a(388),function(e){var t=e.fetchSendMessage,a=e.currentDialogId,s=Object(n.useState)(""),c=Object(j.a)(s,2),l=c[0],i=c[1],o=Object(n.useState)(!1),u=Object(j.a)(o,2),m=u[0],d=u[1];return r.a.createElement("div",{className:"chat-input"},r.a.createElement("div",{className:"chat-input__smile-btn"},m&&r.a.createElement("div",{className:"chat-input__emoji-picker"},r.a.createElement(ie.a,{set:"apple"})),r.a.createElement(_.a,{onClick:function(){d(!m)},type:"link",shape:"circle",icon:"smile"})),r.a.createElement(h.a,{onChange:function(e){return i(e.target.value)},value:l,onKeyUp:function(e){13===e.keyCode&&(t(l,a),i(""))},size:"large",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0442\u0435\u043a\u0441\u0442 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f\u2026"}),r.a.createElement("div",{className:"chat-input__actions"},r.a.createElement(le.UploadField,{onFiles:function(e){return console.log(e)},containerProps:{className:"chat-input__actions-upload-btn"},uploadProps:{accept:".jpg, .jpeg, .png, .gif, .bmp",multiple:"multiple"},multiple:!0},r.a.createElement(_.a,{type:"link",shape:"circle",icon:"camera"})),l?r.a.createElement(_.a,{type:"link",shape:"circle",icon:"check-circle"}):r.a.createElement(_.a,{type:"link",shape:"circle",icon:"audio"})))}),ue=a(488),me=(a(389),function(e){var t=e.isLoading,a=e.items,n=e.blockRef,s=e.user;return r.a.createElement("div",{ref:n,className:y()("messages",{"messages--loading":t})},t?r.a.createElement(ue.a,{size:"large",tip:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0439..."}):a&&!t?a.length>0?a.map(function(e){return r.a.createElement(U,Object.assign({key:e._id,isMe:s._id===e.user._id},e))}):r.a.createElement(ae.a,{description:"\u0414\u0438\u0430\u043b\u043e\u0433 \u043f\u0443\u0441\u0442"}):r.a.createElement(ae.a,{description:"\u041e\u0442\u043a\u0440\u043e\u0439\u0442\u0435 \u0434\u0438\u0430\u043b\u043e\u0433"}))}),de=function(e){var t=e.name,a=e.placeholder,n=e.icon,s=e.type,c=e.handleChange,l=e.handleBlur,i=e.touched,o=e.errors,u=e.values;return r.a.createElement(E.a.Item,{validateStatus:M(t,i,o),help:i[t]?o[t]:"",hasFeedback:!0},r.a.createElement(h.a,{id:t,prefix:r.a.createElement(v.a,{type:n,style:{color:"rgba(0,0,0,.25)"}}),size:"large",placeholder:a,value:u[t],onChange:c,onBlur:l,type:s}))},pe=function(e){var t=e.values,a=e.touched,n=e.errors,s=e.handleChange,c=e.handleBlur,i=e.handleSubmit,o=e.isValid,u=e.isSubmitting;return r.a.createElement("div",null,r.a.createElement("div",{className:"auth__top"},r.a.createElement("h2",null,"\u0412\u043e\u0439\u0442\u0438 \u0432 \u0430\u043a\u043a\u0430\u0443\u043d\u0442"),r.a.createElement("p",null,"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430 \u0432\u043e\u0439\u0434\u0438\u0442\u0435 \u0432 \u0441\u0432\u043e\u0439 \u0430\u043a\u043a\u0430\u0443\u043d\u0442")),r.a.createElement(S,null,r.a.createElement(E.a,{onSubmit:i,className:"login-form"},r.a.createElement(E.a.Item,{validateStatus:M("email",a,n),help:a.email?n.email:"",hasFeedback:!0},r.a.createElement(h.a,{id:"email",prefix:r.a.createElement(v.a,{type:"mail",style:{color:"rgba(0,0,0,.25)"}}),size:"large",placeholder:"E-Mail",value:t.email,onChange:s,onBlur:c})),r.a.createElement(E.a.Item,{validateStatus:M("password",a,n),help:a.password?n.password:"",hasFeedback:!0},r.a.createElement(h.a,{id:"password",prefix:r.a.createElement(v.a,{type:"lock",style:{color:"rgba(0,0,0,.25)"}}),size:"large",type:"password",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",value:t.password,onChange:s,onBlur:c})),r.a.createElement(E.a.Item,null,u&&!o&&r.a.createElement("span",null,"\u041e\u0448\u0438\u0431\u043a\u0430!"),r.a.createElement(O,{disabled:u,onClick:i,type:"primary",size:"large"},"\u0412\u043e\u0439\u0442\u0438 \u0432 \u0430\u043a\u043a\u0430\u0443\u043d\u0442")),r.a.createElement(l.b,{className:"auth__register-link",to:"/register"},"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f"))))},ge=function(e){var t=e.isAuth,a=e.values,n=e.errors,r={email:function(e){e?/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i.test(e)||(n.email="\u041d\u0435\u0432\u0435\u0440\u043d\u044b\u0439 E-Mail"):n.email="\u0412\u0432\u0435\u0434\u0438\u0442\u0435 E-Mail"},password:function(e){e?t||/^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.{8,})/.test(e)||(n.password="\u0421\u043b\u0438\u0448\u043a\u043e\u043c \u043b\u0451\u0433\u043a\u0438\u0439 \u043f\u0430\u0440\u043e\u043b\u044c"):n.password="\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043f\u0430\u0440\u043e\u043b\u044c"},password_2:function(e){console.log(e),t||e===a.password?e||(n.password_2="\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043f\u0430\u0440\u043e\u043b\u044c"):n.password_2="\u041f\u0430\u0440\u043e\u043b\u0438 \u043d\u0435 \u0441\u043e\u0432\u043f\u0430\u0434\u0430\u044e\u0442"},fullname:function(e){t||e||(n.fullname="\u0423\u043a\u0430\u0436\u0438\u0442\u0435 \u0441\u0432\u043e\u0435 \u0438\u043c\u044f \u0438 \u0444\u0430\u043c\u0438\u043b\u0438\u044e")}};Object.keys(a).forEach(function(e){return r[e]&&r[e](a[e])})},fe=a(77),Ee=a.n(fe);Ee.a.defaults.baseURL="https://react-nodejs-mongodb-chat.herokuapp.com/",Ee.a.defaults.headers.common.token=window.localStorage.token,window.axios=Ee.a;var he=Ee.a,ve=function(){return he.get("/dialogs")},_e=function(e){return he.get("/messages?dialog=".concat(e))},be=function(e,t){return he.post("/messages",{text:e,dialog_id:t})},ye=function(e){return he.post("/user/login",e)},Oe=function(e){return he.post("/user/registration",e)},Se=function(e){return he.get("/user/verify?hash="+e)},je=function(){return he.get("/user/me")},Ne={setDialogs:function(e){return{type:"DIALOGS:SET_ITEMS",payload:e}},setCurrentDialogId:function(e){return{type:"DIALOGS:SET_CURRENT_DIALOG_ID",payload:e}},fetchDialogs:function(){return function(e){ve().then(function(t){var a=t.data;e(Ne.setDialogs(a))})}}},we=Ne,De={setMessages:function(e){return{type:"MESSAGES:SET_ITEMS",payload:e}},addMessage:function(e){return function(t,a){a().dialogs.currentDialogId===e.dialog._id&&t({type:"MESSAGES:ADD_MESSAGE",payload:e})}},fetchSendMessage:function(e,t){return function(a){be(e,t)}},setIsLoading:function(e){return{type:"MESSAGES:SET_IS_LOADING",payload:e}},fetchMessages:function(e){return function(t){t(De.setIsLoading(!0)),_e(e).then(function(e){var a=e.data;t(De.setMessages(a))}).catch(function(){t(De.setIsLoading(!1))})}}},Ie=De,Ae={setUserData:function(e){return{type:"USER:SET_DATA",payload:e}},setIsAuth:function(e){return{type:"USER:SET_IS_AUTH",payload:e}},fetchUserData:function(){return function(e){je().then(function(t){var a=t.data;e(Ae.setUserData(a))}).catch(function(t){403===t.response.status&&(e(Ae.setIsAuth(!1)),delete window.localStorage.token)})}},fetchUserLogin:function(e){return function(t){return ye(e).then(function(e){var a=e.data,n=a.status,r=a.token;return"error"===n?P({title:"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438!",text:"\u041d\u0435\u0432\u0435\u0440\u043d\u044b\u0439 \u043b\u043e\u0433\u0438\u043d \u0438\u043b\u0438 \u043f\u0430\u0440\u043e\u043b\u044c.",type:"error"}):(P({title:"\u041e\u0442\u043b\u0438\u0447\u043d\u043e!",text:"\u0410\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u044f \u0443\u0441\u043f\u0435\u0448\u043d\u0430.",type:"success"}),window.axios.defaults.headers.common.token=r,window.localStorage.token=r,t(Ae.fetchUserData()),t(Ae.setIsAuth(!0))),a}).catch(function(e){403===e.response.status&&P({title:"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438",text:"\u041d\u0435\u0432\u0435\u0440\u043d\u044b\u0439 \u043b\u043e\u0433\u0438\u043d \u0438\u043b\u0438 \u043f\u0430\u0440\u043e\u043b\u044c",type:"error"})})}},fetchUserRegister:function(e){return function(t){return Oe(e).then(function(e){return e.data})}}},ke=Ae,Me=Object(f.a)({enableReinitialize:!0,mapPropsToValues:function(){return{email:"",password:""}},validate:function(e){var t={};return ge({isAuth:!0,values:e,errors:t}),t},handleSubmit:function(e,t){var a=t.setSubmitting,n=t.props;(0,n.fetchUserLogin)(e).then(function(e){"success"===e.status&&n.history.push("/im"),a(!1)}).catch(function(){a(!1)})},displayName:"LoginForm"})(pe),Le=Object(i.b)(null,ke)(Me),Re=function(e){var t=e.values,a=e.touched,n=e.errors,s=e.handleChange,c=e.handleBlur,i=e.handleSubmit,o=e.isValid,u=e.isSubmitting;return r.a.createElement("div",null,r.a.createElement("div",{className:"auth__top"},r.a.createElement("h2",null,"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"),r.a.createElement("p",null,"\u0414\u043b\u044f \u0432\u0445\u043e\u0434\u0430 \u0432 \u0447\u0430\u0442, \u0432\u0430\u043c \u043d\u0443\u0436\u043d\u043e \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f")),r.a.createElement(S,null,r.a.createElement(E.a,{onSubmit:i,className:"login-form"},r.a.createElement(de,{name:"email",icon:"mail",placeholder:"E-Mail",handleChange:s,handleBlur:c,touched:a,errors:n,values:t}),r.a.createElement(de,{name:"fullname",icon:"user",placeholder:"\u0412\u0430\u0448\u0435 \u0438\u043c\u044f \u0438 \u0444\u0430\u043c\u0438\u043b\u0438\u044f",handleChange:s,handleBlur:c,touched:a,errors:n,values:t}),r.a.createElement(de,{name:"password",icon:"lock",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",type:"password",handleChange:s,handleBlur:c,touched:a,errors:n,values:t}),r.a.createElement(de,{name:"password_2",icon:"lock",placeholder:"\u041f\u043e\u0432\u0442\u043e\u0440\u0438\u0442\u0435 \u043f\u0430\u0440\u043e\u043b\u044c",type:"password",handleChange:s,handleBlur:c,touched:a,errors:n,values:t}),r.a.createElement(E.a.Item,null,u&&!o&&r.a.createElement("span",null,"\u041e\u0448\u0438\u0431\u043a\u0430!"),r.a.createElement(O,{disabled:u,onClick:i,type:"primary",size:"large"},"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f")),r.a.createElement(l.b,{className:"auth__register-link",to:"/login"},"\u0412\u043e\u0439\u0442\u0438 \u0432 \u0430\u043a\u043a\u0430\u0443\u043d\u0442"))))},Te=Object(f.a)({enableReinitialize:!0,mapPropsToValues:function(){return{email:"",fullname:"",password:"",password_2:""}},validate:function(e){var t={};return ge({isAuth:!1,values:e,errors:t}),t},handleSubmit:function(e,t){var a=t.setSubmitting,n=t.props;(0,n.fetchUserRegister)(e).then(function(e){"success"===e.status&&n.history.push("/im"),a(!1)}).catch(function(){a(!1)})},displayName:"RegisterForm"})(Re),Pe=Object(i.b)(null,ke)(Te),Ce=a(491),xe=function(e,t){var a=e.location,s=e.history,c=Object(n.useState)(!1),l=Object(j.a)(c,2),i=l[0],o=l[1],u=a.search.split("hash=")[1],m=function(e,t){return e?t?{status:"success",message:"\u0410\u043a\u043a\u0430\u0443\u043d\u0442 \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d!"}:{status:"error",message:"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u0438\u0438 \u0430\u043a\u043a\u0430\u0443\u043d\u0442\u0430!"}:{status:"success",message:"\u0421\u0441\u044b\u043b\u043a\u0430 \u0441 \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u0438\u0435\u043c \u0430\u043a\u043a\u0430\u0443\u043d\u0442\u0430 \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0430 \u043d\u0430 E-Mail."}}(u,i);return Object(n.useEffect)(function(){u&&Se(u).then(function(e){"success"===e.data.status&&o(!0)})}),r.a.createElement("div",null,r.a.createElement(S,null,r.a.createElement(Ce.a,{status:m.status,title:"success"===m.status?"\u0413\u043e\u0442\u043e\u0432\u043e!":"\u041e\u0448\u0438\u0431\u043a\u0430",subTitle:m.message,extra:"success"===m.status&&i&&r.a.createElement(_.a,{type:"primary",onClick:function(){return s.push("/login")}},"\u0412\u043e\u0439\u0442\u0438")})))},Ue=(a(452),function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return r.a.createElement("section",{className:"auth"},r.a.createElement("div",{className:"auth__content"},r.a.createElement(o.b,{exact:!0,path:["/","/login"],component:Le}),r.a.createElement(o.b,{exact:!0,path:"/register",component:Pe}),r.a.createElement(o.b,{exact:!0,path:"/register/verify",component:xe})))}}]),t}(r.a.Component)),Ge=a(217),ze=a.n(Ge)()("https://react-nodejs-mongodb-chat.herokuapp.com/"),Be=Object(i.b)(function(e){return e.dialogs},we)(function(e){var t=e.items,a=e.userId,s=e.setCurrentDialogId,c=e.currentDialogId,l=e.fetchDialogs,i=Object(n.useState)(""),o=Object(j.a)(i,2),u=o[0],m=o[1],d=Object(n.useState)(Array.from(t)),p=Object(j.a)(d,2),g=p[0],f=p[1],E=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";f(t.filter(function(t){return t.author.fullname.toLowerCase().indexOf(e.toLowerCase())>=0||t.partner.fullname.toLowerCase().indexOf(e.toLowerCase())>=0})),m(e)},h=function(){l()};return Object(n.useEffect)(function(){t.length&&E()},[t]),Object(n.useEffect)(function(){return l(),ze.on("SERVER:DIALOG_CREATED",h),function(){return ze.removeListener("SERVER:DIALOG_CREATED",h)}},[]),r.a.createElement(ne,{userId:a,items:g,onSearch:E,inputValue:u,onSelectDialog:s,currentDialogId:c})}),Ve=Object(i.b)(function(e){var t=e.messages,a=e.dialogs,n=e.user;return{items:t.items,currentDialogId:a.currentDialogId,isLoading:t.isLoading,user:n.data}},Ie)(function(e){var t=e.currentDialogId,a=e.fetchMessages,s=e.addMessage,c=e.items,l=e.isLoading,i=e.user,o=Object(n.useRef)(null),u=function(e){s(e)};return Object(n.useEffect)(function(){return t&&a(t),ze.on("SERVER:NEW_MESSAGE",u),function(){return ze.removeListener("SERVER:NEW_MESSAGE",u)}},[t]),Object(n.useEffect)(function(){o.current.scrollTo(0,o.current.scrollHeight)},[c]),r.a.createElement(me,{blockRef:o,items:c,isLoading:l,user:i})}),Fe=Object(i.b)(function(e){return e.dialogs},Ie)(oe),He=Object(i.b)(function(e){var t=e.dialogs,a=e.user;return{dialogs:t.items,currentDialogId:t.currentDialogId,user:a.data}})(function(e){var t=e.currentDialogId,a=e.user,n=e.dialogs;if(!n.length||!t)return null;var s=n.filter(function(e){return e._id===t})[0],c={};return c=s.author._id===a._id?s.partner:s.author,r.a.createElement(ce,{online:c.isOnline,fullname:c.fullname})}),Ze=(a(484),function(){return r.a.createElement("section",{className:"home"},r.a.createElement("div",{className:"chat"},r.a.createElement("div",{className:"chat__sidebar"},r.a.createElement("div",{className:"chat__sidebar-header"},r.a.createElement("div",null,r.a.createElement(v.a,{type:"team"}),r.a.createElement("span",null,"\u0421\u043f\u0438\u0441\u043e\u043a \u0434\u0438\u0430\u043b\u043e\u0433\u043e\u0432")),r.a.createElement(_.a,{type:"link",shape:"circle",icon:"form"})),r.a.createElement("div",{className:"chat__sidebar-dialogs"},r.a.createElement(Be,{userId:0}))),r.a.createElement("div",{className:"chat__dialog"},r.a.createElement("div",{className:"chat__dialog-header"},r.a.createElement("div",null),r.a.createElement(He,null),r.a.createElement(_.a,{type:"link",shape:"circle",icon:"ellipsis"})),r.a.createElement("div",{className:"chat__dialog-messages"},r.a.createElement(Ve,null)),r.a.createElement("div",{className:"chat__dialog-input"},r.a.createElement(Fe,null)))))}),We=Object(i.b)(function(e){return{isAuth:e.user.isAuth}})(function(e){var t=e.isAuth;return r.a.createElement("div",{className:"wrapper"},r.a.createElement(o.d,null,r.a.createElement(o.b,{exact:!0,path:["/login","/register","/register/verify"],component:Ue}),r.a.createElement(o.b,{path:"/",render:function(){return t?r.a.createElement(Ze,null):r.a.createElement(o.a,{to:"/login"})}})))}),Je=a(42),Xe=a(218),Ke=a(61);function $e(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function qe(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?$e(a,!0).forEach(function(t){Object(Ke.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):$e(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}var Qe={items:[],currentDialogId:window.location.pathname.split("dialog/")[1],isLoading:!1},Ye=a(221);function et(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function tt(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?et(a,!0).forEach(function(t){Object(Ke.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):et(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}var at={items:[],isLoading:!1};function nt(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function rt(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?nt(a,!0).forEach(function(t){Object(Ke.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):nt(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}var st={data:null,token:window.localStorage.token,isAuth:!!window.localStorage.token},ct=Object(Je.c)({dialogs:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Qe,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case"DIALOGS:SET_ITEMS":return qe({},e,{items:n});case"DIALOGS:SET_CURRENT_DIALOG_ID":return qe({},e,{currentDialogId:n});default:return e}},messages:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:at,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case"MESSAGES:ADD_MESSAGE":return tt({},e,{items:[].concat(Object(Ye.a)(e.items),[n])});case"MESSAGES:SET_ITEMS":return tt({},e,{items:n,isLoading:!1});case"MESSAGES:SET_IS_LOADING":return tt({},e,{isLoading:n});default:return e}},user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:st,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case"USER:SET_DATA":return rt({},e,{data:n,token:window.localStorage.token,isAuth:!0});case"USER:SET_IS_AUTH":return rt({},e,{isAuth:n});default:return e}}}),lt=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||Je.d,it=[Xe.a],ot=lt(Je.a.apply(void 0,it)),ut=Object(Je.e)(ct,ot);a(485),a(486);ut.dispatch(ke.fetchUserData()),c.a.render(r.a.createElement(l.a,null,r.a.createElement(i.a,{store:ut},r.a.createElement(We,null))),document.getElementById("root"))}},[[226,1,2]]]);
//# sourceMappingURL=main.515a6da5.chunk.js.map